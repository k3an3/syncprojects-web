"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,s){for(var e=0;e<s.length;e++){var i=s[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,s,e){return s&&_defineProperties(t.prototype,s),e&&_defineProperties(t,e),t}var CONTAINER_CLASS="toast-container",WRAPPER_CLASS="toast-wrapper",BsToast=function(){function t(s){var e=s.title,i=s.subtitle,a=s.content,o=s.type,n=s.delay,c=s.position,h=s.img,l=s.icon,r=s.pause_on_hover,d=s.customClass;_classCallCheck(this,t),this.id="toast-"+(document.getElementsByClassName("toast").length+1),this.title=e||"Notice!",this.subtitle=i||"",this.content=a||"",this.type=o||"info",this.delay=n||-1,this.position=c||"top-right",this.img=h,this.icon=l,this.pause_on_hover=r||!1,this.customClass=d||"",this.pause=!1,this.bg_header_class="",this.fg_header_class="",this.fg_subtitle_class="text-muted",this.fg_dismiss_class="",this.delay_or_autohide="",this.setupLayout(),this.createToast()}return _createClass(t,[{key:"setupLayout",value:function(){if(!document.getElementsByClassName(CONTAINER_CLASS+" "+this.position).length){var t=document.createElement("div");t.className=CONTAINER_CLASS+" "+this.position,document.body.insertBefore(t,document.body.firstChild)}if(!document.getElementsByClassName(CONTAINER_CLASS+" "+this.position)[0].hasChildNodes()){var s=document.createElement("div");s.className=WRAPPER_CLASS,document.getElementsByClassName(CONTAINER_CLASS+" "+this.position)[0].append(s)}}},{key:"createToast",value:function(){var s=this;if(!1!==this.pause_on_hover){var e=Math.floor(Date.now()/1e3)+this.delay/1e3;this.delay_or_autohide='data-autohide="false"',this.pause_on_hover='data-hide-timestamp="'.concat(e,'"')}else-1===this.delay?this.delay_or_autohide='data-autohide="false"':this.delay_or_autohide='data-delay="'.concat(this.delay,'"');if(!this.customClass)switch(this.type){case"info":this.bg_header_class="bg-info",this.fg_header_class="text-white",this.fg_subtitle_class="text-white",this.fg_dismiss_class="text-white";break;case"success":this.bg_header_class="bg-success",this.fg_header_class="text-white",this.fg_subtitle_class="text-white",this.fg_dismiss_class="text-white";break;case"warning":case"warn":this.bg_header_class="bg-warning",this.fg_header_class="text-white",this.fg_subtitle_class="text-white",this.fg_dismiss_class="text-white";break;case"error":case"danger":this.bg_header_class="bg-danger",this.fg_header_class="text-white",this.fg_subtitle_class="text-white",this.fg_dismiss_class="text-white"}var i='\n<div id="'.concat(this.id,'" class="toast').concat(" "+this.customClass,'" role="alert" aria-live="assertive" aria-atomic="true" ').concat(this.delay_or_autohide," ").concat(this.pause_on_hover,'>\n  <div class="toast-header ').concat(this.bg_header_class," ").concat(this.fg_header_class,'">');void 0!==this.img&&void 0===this.icon&&(i+='<img src="'.concat(this.img.src,'" class="').concat(this.img.class||"",' mr-2" alt="').concat(this.img.alt||"Image",'" ').concat(void 0!==this.img.title?'data-toggle="tooltip" title="'+this.img.title+'"':"",">")),void 0!==this.icon&&void 0===this.img&&(i+=this.icon),i+='\n    <strong class="mr-auto '.concat(void 0!==this.icon?"ml-2":"",'">').concat(this.title,'</strong>\n    <small class="').concat(this.fg_subtitle_class,'">').concat(this.subtitle,'</small>\n    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close" hidden>\n      <span aria-hidden="true" class="').concat(this.fg_dismiss_class,'">&times;</span>\n    </button>\n  </div>'),""!==this.content&&(i+='<div class="toast-body">\n                        '.concat(this.content,"\n                      </div>")),i+="\n</div>\n";var a=document.createElement("div");a.innerHTML=i;var o=document.getElementsByClassName(CONTAINER_CLASS+" "+this.position)[0].firstChild.appendChild(a);if(t.toggleToast(this.id),!1!==this.pause_on_hover){setTimeout(function(){s.pause||t.toggleToast(s.id,!0)},this.delay),o.addEventListener("mouseover",function(){s.pause=!0});o.addEventListener("mouseleave",function(){var e=Math.floor(Date.now()/1e3),i=parseInt(o.children[0].dataset.hideTimestamp);s.pause=!1,e>=i&&t.toggleToast(s.id,!0)})}}}],[{key:"toggleToast",value:function(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=new bootstrap.Toast(document.getElementById(t));s?e.hide():e.show()}}]),t}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvYXN0LmpzIl0sIm5hbWVzIjpbIkNPTlRBSU5FUl9DTEFTUyIsIldSQVBQRVJfQ0xBU1MiLCJCc1RvYXN0IiwiX3JlZiIsInRpdGxlIiwic3VidGl0bGUiLCJjb250ZW50IiwidHlwZSIsImRlbGF5IiwicG9zaXRpb24iLCJpbWciLCJpY29uIiwicGF1c2Vfb25faG92ZXIiLCJjdXN0b21DbGFzcyIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJpZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImxlbmd0aCIsInBhdXNlIiwiZmdfaGVhZGVyX2NsYXNzIiwiZmdfc3VidGl0bGVfY2xhc3MiLCJkZWxheV9vcl9hdXRvaGlkZSIsInNldHVwTGF5b3V0IiwiY3JlYXRlVG9hc3QiLCJjb250YWluZXIiLCJjcmVhdGVFbGVtZW50IiwiYm9keSIsImluc2VydEJlZm9yZSIsImZpcnN0Q2hpbGQiLCJoYXNDaGlsZE5vZGVzIiwid3JhcHBlciIsImJnX2hlYWRlcl9jbGFzcyIsImFwcGVuZCIsImhpZGVfdGltZXN0YW1wIiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsIm5vdyIsImNvbmNhdCIsImNsYXNzTmFtZSIsImZnX2Rpc21pc3NfY2xhc3MiLCJodG1sIiwic3JjIiwiYWx0IiwidG9hc3RFbCIsImlubmVySFRNTCIsImVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInRvZ2dsZVRvYXN0IiwiX3RoaXMiLCJtb3VzZUxlYXZlIiwiZnV0dXJlIiwicGFyc2VJbnQiLCJjaGlsZHJlbiIsImRhdGFzZXQiLCJoaWRlVGltZXN0YW1wIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhpZGUiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJ3aW5kb3ciLCJjdXJyZW50IiwiJCIsInRvYXN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJzaG93Il0sIm1hcHBpbmdzIjoibVpBQUEsSUFBTUEsZ0JBQWtCLGtCQUNsQkMsY0FBZ0IsZ0JBRWhCQyxtQkFFRixTQUFBQSxFQUFBQyxH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ZCxLQUFJQyxNQUFLQyxLQUE3QkMsTUFBQSxLQUNIYyxFQUFBQyxTQUFBTixFQUFBTyxTQUFBLEdBQUFDLFFBQUFDLGVBWUROLEVBQUsvQixPQUFRLEVBUlRzQyxHQUFBQSxHQUNDdEMsRUFBTDhCLFlBQUFDLEVBQUFuQyxJQUFBLDRDQWlCT0EsR0FBa0IsSUFBZDJDLEVBQWNDLFVBQUF6QyxPQUFBLFFBQUEwQyxJQUFBRCxVQUFBLElBQUFBLFVBQUEsR0FSekIsR0FBQUUsT0FBSUMsUUFBSkQsT0FBdUJFLEVBYTNCQSxFQUFDLElBQUF4QixPQUFLeEIsSUFBTWlELE1BQU1OLEVBQU8sT0FBUyxZQWJQLENBQ25CekQsSUFBQUEsRUFBUWdELElBQUFBLFVBQWlCbEMsTUFBSUMsU0FBN0JpRCxlQUFBbEQsSUFDSDJDLEVBQUFNLEVBQUFOLE9BQUFNLEVBQUFFIiwiZmlsZSI6InRvYXN0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IENPTlRBSU5FUl9DTEFTUyA9IFwidG9hc3QtY29udGFpbmVyXCI7XHJcbmNvbnN0IFdSQVBQRVJfQ0xBU1MgPSBcInRvYXN0LXdyYXBwZXJcIjtcclxuXHJcbmNsYXNzIEJzVG9hc3Qge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHt0aXRsZSwgc3VidGl0bGUsIGNvbnRlbnQsIHR5cGUsIGRlbGF5LCBwb3NpdGlvbiwgaW1nLCBpY29uLCBwYXVzZV9vbl9ob3ZlciwgY3VzdG9tQ2xhc3N9KSB7XHJcbiAgICAgICAgdGhpcy5pZCA9ICd0b2FzdC0nICsgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3RvYXN0JykubGVuZ3RoICsgMSk7XHJcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlIHx8ICdOb3RpY2UhJztcclxuICAgICAgICB0aGlzLnN1YnRpdGxlID0gc3VidGl0bGUgfHwgJyc7XHJcbiAgICAgICAgdGhpcy5jb250ZW50ID0gY29udGVudCB8fCAnJztcclxuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlIHx8ICdpbmZvJztcclxuICAgICAgICB0aGlzLmRlbGF5ID0gZGVsYXkgfHwgLTE7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uIHx8ICd0b3AtcmlnaHQnO1xyXG4gICAgICAgIHRoaXMuaW1nID0gaW1nO1xyXG4gICAgICAgIHRoaXMuaWNvbiA9IGljb247XHJcbiAgICAgICAgdGhpcy5wYXVzZV9vbl9ob3ZlciA9IHBhdXNlX29uX2hvdmVyIHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY3VzdG9tQ2xhc3MgPSBjdXN0b21DbGFzcyB8fCAnJztcclxuXHJcbiAgICAgICAgdGhpcy5wYXVzZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJnX2hlYWRlcl9jbGFzcyA9ICcnO1xyXG4gICAgICAgIHRoaXMuZmdfaGVhZGVyX2NsYXNzID0gJyc7XHJcbiAgICAgICAgdGhpcy5mZ19zdWJ0aXRsZV9jbGFzcyA9ICd0ZXh0LW11dGVkJztcclxuICAgICAgICB0aGlzLmZnX2Rpc21pc3NfY2xhc3MgPSAnJztcclxuXHJcbiAgICAgICAgdGhpcy5kZWxheV9vcl9hdXRvaGlkZSA9ICcnO1xyXG5cclxuICAgICAgICB0aGlzLnNldHVwTGF5b3V0KCk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVUb2FzdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldHVwTGF5b3V0KCkge1xyXG4gICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShDT05UQUlORVJfQ0xBU1MgKyAnICcgKyB0aGlzLnBvc2l0aW9uKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gQ09OVEFJTkVSX0NMQVNTICsgJyAnICsgdGhpcy5wb3NpdGlvbjtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pbnNlcnRCZWZvcmUoY29udGFpbmVyLCBkb2N1bWVudC5ib2R5LmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKENPTlRBSU5FUl9DTEFTUyArICcgJyArIHRoaXMucG9zaXRpb24pWzBdLmhhc0NoaWxkTm9kZXMoKSkge1xyXG4gICAgICAgICAgICBsZXQgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICB3cmFwcGVyLmNsYXNzTmFtZSA9IFdSQVBQRVJfQ0xBU1M7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoQ09OVEFJTkVSX0NMQVNTICsgJyAnICsgdGhpcy5wb3NpdGlvbilbMF0uYXBwZW5kKHdyYXBwZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVUb2FzdCgpIHtcclxuICAgICAgICBpZiAodGhpcy5wYXVzZV9vbl9ob3ZlciAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29uc3QgaGlkZV90aW1lc3RhbXAgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArICh0aGlzLmRlbGF5IC8gMTAwMCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmRlbGF5X29yX2F1dG9oaWRlID0gJ2RhdGEtYXV0b2hpZGU9XCJmYWxzZVwiJztcclxuICAgICAgICAgICAgdGhpcy5wYXVzZV9vbl9ob3ZlciA9IGBkYXRhLWhpZGUtdGltZXN0YW1wPVwiJHtoaWRlX3RpbWVzdGFtcH1cImA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGVsYXkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlbGF5X29yX2F1dG9oaWRlID0gJ2RhdGEtYXV0b2hpZGU9XCJmYWxzZVwiJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVsYXlfb3JfYXV0b2hpZGUgPSBgZGF0YS1kZWxheT1cIiR7dGhpcy5kZWxheX1cImA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIElmIGN1c3RvbSBjbGFzcyBpcyBkZWZpbmVkIHRoZW4gZG9uJ3Qgc3R5bGUgdGhlIHRvYXN0IGJ5IGl0J3MgdHlwZS5cclxuICAgICAgICBpZighdGhpcy5jdXN0b21DbGFzcykge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnaW5mbyc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iZ19oZWFkZXJfY2xhc3MgPSAnYmctaW5mbyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZ19oZWFkZXJfY2xhc3MgPSAndGV4dC13aGl0ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZ19zdWJ0aXRsZV9jbGFzcyA9ICd0ZXh0LXdoaXRlJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZnX2Rpc21pc3NfY2xhc3MgPSAndGV4dC13aGl0ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnc3VjY2Vzcyc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iZ19oZWFkZXJfY2xhc3MgPSAnYmctc3VjY2Vzcyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZ19oZWFkZXJfY2xhc3MgPSAndGV4dC13aGl0ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZ19zdWJ0aXRsZV9jbGFzcyA9ICd0ZXh0LXdoaXRlJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZnX2Rpc21pc3NfY2xhc3MgPSAndGV4dC13aGl0ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnd2FybmluZyc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICd3YXJuJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJnX2hlYWRlcl9jbGFzcyA9ICdiZy13YXJuaW5nJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZnX2hlYWRlcl9jbGFzcyA9ICd0ZXh0LXdoaXRlJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZnX3N1YnRpdGxlX2NsYXNzID0gJ3RleHQtd2hpdGUnO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmdfZGlzbWlzc19jbGFzcyA9ICd0ZXh0LXdoaXRlJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkYW5nZXInOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmdfaGVhZGVyX2NsYXNzID0gJ2JnLWRhbmdlcic7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZ19oZWFkZXJfY2xhc3MgPSAndGV4dC13aGl0ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZ19zdWJ0aXRsZV9jbGFzcyA9ICd0ZXh0LXdoaXRlJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZnX2Rpc21pc3NfY2xhc3MgPSAndGV4dC13aGl0ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBodG1sID0gYFxyXG48ZGl2IGlkPVwiJHt0aGlzLmlkfVwiIGNsYXNzPVwidG9hc3QkeycgJyArIHRoaXMuY3VzdG9tQ2xhc3N9XCIgcm9sZT1cImFsZXJ0XCIgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCIgYXJpYS1hdG9taWM9XCJ0cnVlXCIgJHt0aGlzLmRlbGF5X29yX2F1dG9oaWRlfSAke3RoaXMucGF1c2Vfb25faG92ZXJ9PlxyXG4gIDxkaXYgY2xhc3M9XCJ0b2FzdC1oZWFkZXIgJHt0aGlzLmJnX2hlYWRlcl9jbGFzc30gJHt0aGlzLmZnX2hlYWRlcl9jbGFzc31cIj5gO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHRoaXMuaW1nICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgdGhpcy5pY29uID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICBodG1sICs9IGA8aW1nIHNyYz1cIiR7dGhpcy5pbWcuc3JjfVwiIGNsYXNzPVwiJHsodGhpcy5pbWcuY2xhc3MgfHwgJycpfSBtci0yXCIgYWx0PVwiJHsodGhpcy5pbWcuYWx0IHx8ICdJbWFnZScpfVwiICR7KHR5cGVvZiB0aGlzLmltZy50aXRsZSAhPT0gJ3VuZGVmaW5lZCcgPyAnZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgdGl0bGU9XCInICsgdGhpcy5pbWcudGl0bGUgKyAnXCInIDogJycpfT5gO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmljb24gIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiB0aGlzLmltZyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICBodG1sICs9IHRoaXMuaWNvbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGh0bWwgKz0gYFxyXG4gICAgPHN0cm9uZyBjbGFzcz1cIm1yLWF1dG8gJHsodHlwZW9mIHRoaXMuaWNvbiAhPT0gJ3VuZGVmaW5lZCcpID8gJ21sLTInIDogJycgfVwiPiR7dGhpcy50aXRsZX08L3N0cm9uZz5cclxuICAgIDxzbWFsbCBjbGFzcz1cIiR7dGhpcy5mZ19zdWJ0aXRsZV9jbGFzc31cIj4ke3RoaXMuc3VidGl0bGV9PC9zbWFsbD5cclxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwibWwtMiBtYi0xIGNsb3NlXCIgZGF0YS1kaXNtaXNzPVwidG9hc3RcIiBhcmlhLWxhYmVsPVwiQ2xvc2VcIj5cclxuICAgICAgPHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCIgY2xhc3M9XCIke3RoaXMuZmdfZGlzbWlzc19jbGFzc31cIj4mdGltZXM7PC9zcGFuPlxyXG4gICAgPC9idXR0b24+XHJcbiAgPC9kaXY+YDtcclxuICAgICAgICBpZiAodGhpcy5jb250ZW50ICE9PSAnJykge1xyXG4gICAgICAgICAgICBodG1sICs9IGA8ZGl2IGNsYXNzPVwidG9hc3QtYm9keVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAke3RoaXMuY29udGVudH1cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGh0bWwgKz0gYFxyXG48L2Rpdj5cclxuYDtcclxuXHJcbiAgICAgICAgbGV0IHRvYXN0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICB0b2FzdEVsLmlubmVySFRNTCA9IGh0bWw7XHJcblxyXG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKENPTlRBSU5FUl9DTEFTUyArICcgJyArIHRoaXMucG9zaXRpb24pWzBdLmZpcnN0Q2hpbGQuYXBwZW5kQ2hpbGQodG9hc3RFbCk7XHJcbiAgICAgICAgQnNUb2FzdC50b2dnbGVUb2FzdCh0aGlzLmlkKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucGF1c2Vfb25faG92ZXIgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGxldCB0aW1lb3V0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnBhdXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQnNUb2FzdC50b2dnbGVUb2FzdCh0aGlzLmlkLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCh0aW1lb3V0LCB0aGlzLmRlbGF5KTtcclxuXHJcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXVzZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbGV0IG1vdXNlTGVhdmUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmdXR1cmUgPSBwYXJzZUludChlbGVtZW50LmNoaWxkcmVuWzBdLmRhdGFzZXQuaGlkZVRpbWVzdGFtcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXVzZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ID49IGZ1dHVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIEJzVG9hc3QudG9nZ2xlVG9hc3QodGhpcy5pZCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIG1vdXNlTGVhdmUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgdG9nZ2xlVG9hc3QoaWQsIGhpZGUgPSBmYWxzZSkge1xyXG4gICAgICAgIGlmICghd2luZG93LmpRdWVyeSAmJiAhd2luZG93LiQpIHtcclxuICAgICAgICAgICAgbGV0IHRvYXN0ID0gbmV3IGJvb3RzdHJhcC5Ub2FzdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkpO1xyXG4gICAgICAgICAgICBoaWRlID8gdG9hc3QuaGlkZSgpIDogdG9hc3Quc2hvdygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQoYCMke2lkfWApLnRvYXN0KGhpZGUgPyAnaGlkZScgOiAnc2hvdycpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=